<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Chi·∫øn Binh R·ªìng Thi√™ng</title>
  <link rel="stylesheet" href="style.css" />
  <link rel="icon" href="images/icongame1.png" type="image/png" />
  <style>
    .vip strong{
      color:#1976d2
    }
    body.dark-mode .vip strong{
      color:#ffa500;
    }
    #toast {
    position: fixed;
    opacity:0;
    bottom:66%;
    left: 50%;
    transform: translateX(-50%);
    background: #9e9e9e;
    box-shadow: 0 4px 12px rgba(0,0,0,0.7);
    color: black;
    padding: 8px 20px;
    border-radius: 8px;
    font-size: 14px;
    z-index: 9999;
    transition: opacity 0.5s ease, transform 0.5s ease;
    }
    body.dark-mode #toast {
    background: rgba(0, 0, 0, 0.8);
    box-shadow: 0 4px 12px rgba(255,255,255,0.2);
    color: #fff;
    }
    #toast.show {
    opacity: 1;
    transform: translateX(-50%) translateY(0);
    }
    #toast.hidden {
    opacity: 0;
    pointer-events: none;
    }
    .avatar-frame {
    border-radius: 50%;
    object-fit: cover;
    border: 3px solid transparent;
    }

    .vip-frame-0 { border-color: gray; }
    .vip-frame-1 { border-color: #ffeb3b; box-shadow: 0 0 6px #ffeb3b}
    .vip-frame-2 { border-color: #ffc107; box-shadow: 0 0 8px #ffc107 }
    .vip-frame-3 { border-color: gold; box-shadow: 0 0 10px gold }
    .vip-frame-4 { border-color: #ff1744;box-shadow: 0 0 8px #ff1744 }
    .vip-frame-5 { border-color: #2979ff; box-shadow: 0 0 8px #2979ff }
    .vip-frame-6 { border-color: #ec407a;box-shadow: 0 0 8px #ec407a }
    .vip-frame-7 { border-color: #b2ebf2; box-shadow: 0 0 10px #b2ebf2 }
    .vip-frame-8 { border-color: #00e5ff; box-shadow: 0 0 10px #00e5ff}
    .legendary-frame {
    border-color: #ffffff;
    box-shadow: 0 0 15px #ffffff
    }
    .badge {
    display: inline-block;
    background: linear-gradient(to right, #ffcc00, #ff9900);
    color: white;
    padding: 4px 10px;
    border-radius: 20px;
    font-size: 13px;
    margin: 3px;
    box-shadow: 0 2px 15px rgba(255,165,0,0.5);
    }
    @media (max-width: 768px) {
        table{
            font-size:11px;
        }
        button {
            font-size:10px;
            padding:6px 12px
        }
        .vbar {
            height:12px !important;
        }
        #avatar-nguoi-choi{
            width:100px !important;
            height: 100px !important;
        }
    }


  </style>
</head>
<body>
  <div class="header">
    <div style="overflow: hidden;">
      <video autoplay muted loop playsinline preload="auto" poster="images/quenmatkhau2.webp" class="header-video" style="animation: vid1 10s infinite;height:100%;filter: brightness(0.9)">
        <source src="images/quenmatkhau2.mp4" type="video/mp4">
      </video>
      <video autoplay muted loop playsinline preload="auto" poster="images/tintuc2.webp" class="header-video" style="animation: vid2 10s infinite;filter: brightness(0.9)">
        <source src="images/tintuc2.mp4" type="video/mp4">
      </video>
    </div>
    <div class="overlay"></div>
        <div class="header-content" >
            <h1>Profile Chi·∫øn Binh!</h1>
            <div>
              <ul>
                <li><a href="index.html">Trang ch·ªß</a></li>
                <li><a href="gioithieu.html">Gi·ªõi thi·ªáu</a></li>
                <li><a href="nhanvat.html">Nh√¢n V·∫≠t</a></li>
                <li><a href="diendan.html">Di·ªÖn ƒë√†n</a></li>
                <li><a href="https://www.facebook.com/people/Chi%E1%BA%BFn-Binh-R%E1%BB%93ng-Thi%C3%AAng/61576541835732/" target="_blank">Fanpage</a></li>
                <li><a href="tintuc.html">Tin t·ª©c</a></li>
                <li><a href="huongdanchoi.html">H∆∞·ªõng d·∫´n ch∆°i</a></li>
                <li><a href="choingay.html">Ch∆°i ngay</a></li>
                <li><a href="naptien.html">N·∫°p game</a></li>
                <li><a href="shop.html">Shop r·ªìng thi√™ng</a></li>
                <li><a href="chatbot.html">Chat bot h·ªó tr·ª£</a></li>
                <li><a href="profile.html" id="selected">Profile</a></li>
              </ul>
            </div>
        </div>
    </div>

    <div class="bg-content1">
        <div style="float:right;margin-top:5px">
            <label class="switch">
                <input type="checkbox" id="darkModeToggle">
                <span class="slider round"></span>
            </label>
        </div>
        <h2>Truy·ªÅn Thuy·∫øt R·ªìng Thi√™ng B·∫Øt ƒê·∫ßu T·ª´ B·∫°n</h2>
        <p><i><b>Kh√¥ng ph·∫£i ai c≈©ng ƒë·ªß s·ª©c m·∫°nh ƒë·ªÉ vi·∫øt n√™n huy·ªÅn tho·∫°i... Nh∆∞ng b·∫°n ƒëang l√†m ƒëi·ªÅu ƒë√≥ ngay l√∫c n√†y!</b></i></p>
    </div>
    <div class="bg-content1">
        <h2>Th√¥ng tin ng∆∞·ªùi ch∆°i</h2>
        <div style="text-align:center; margin-bottom:10px;">
            <img id="avatar-nguoi-choi" class="avatar-frame" src="images/head1.webp" style="width:140px; height:140px;">
        </div>
        <p>T√™n t√†i kho·∫£n: <strong id="ten-nguoi-choi">...</strong></p>
        <p>S·ªë Zeni hi·ªán c√≥: <strong id="kc-hientai">0</strong></p>
        <p class="vip">C·∫•p b·∫≠c chi·∫øn binh: <strong id="cap-bac"><span>VIP 0</span></strong></p>
        <div id="danh-hieu" style="margin:10px 0;"></div>
        <div style="margin-top:10px;">
            <div class="vbar"style="background:#ccc; width:100%; height:20px; border-radius:10px; overflow:hidden;">
                <div id="vip-bar" style="height:100%; width:0%; background:#f90;"></div>
            </div>
            <p id="vip-next" style="margin-top:5px;font-style: italic;"></p>
        </div>
        <button id="nut-dang-nhap" style="margin-top: 10px;">ƒêƒÉng nh·∫≠p</button>
    </div>
    <div class="bg-content1">
    <h2>L·ªãch s·ª≠ n·∫°p Zeni g·∫ßn ƒë√¢y</h2>
    <table border="1" style="width:100%;text-align:center">
        <thead>
        <tr>
            <th>Th·ªùi gian</th>
            <th>S·ªë Zeni</th>
            <th>VNƒê</th>
        </tr>
        </thead>
        <tbody id="lich-su-nap"></tbody>
    </table>
    </div>
    <div class="bg-content1">
    <h2>üéí V·∫≠t ph·∫©m ƒë√£ s·ªü h·ªØu</h2>
    <table border="1" style="width:100%;text-align:center">
        <thead>
        <tr>
            <th>Th·ªùi gian</th>
            <th>V·∫≠t ph·∫©m</th>
            <th>Gi√° (Zeni)</th>
            <th>M√£ Code</th>
        </tr>
        </thead>
        <tbody id="lich-su-item"></tbody>
    </table>
    </div>
    <audio id="bg-music" autoplay loop>
        <source src="sounds/phepmau.mp3" type="audio/mpeg">
        Tr√¨nh duy·ªát c·ªßa b·∫°n kh√¥ng h·ªó tr·ª£ √¢m thanh.
    </audio>
    <button id="toggle-music" class="music-toggle-btn">üîá</button>
    <footer>
        <p style="font-style: italic;"><strong>¬© 2025 Chi·∫øn Binh R·ªìng Thi√™ng | Ph·∫°m H·∫£i ƒêƒÉng</strong></p>
    </footer>
    <div id="toast"></div>
    <script>
        const toggle = document.getElementById("darkModeToggle");

        // Khi t·∫£i trang: ki·ªÉm tra tr·∫°ng th√°i dark mode ƒë√£ l∆∞u
        if (localStorage.getItem("darkMode") === "true") {
        document.body.classList.add("dark-mode");
        toggle.checked = true;
        }

        // Khi ng∆∞·ªùi d√πng b·∫≠t/t·∫Øt dark mode
        toggle.addEventListener("change", function () {
        const isDark = toggle.checked;
        document.body.classList.toggle("dark-mode", isDark);
        localStorage.setItem("darkMode", isDark);
        });
        //audio 
        const bgMusic = document.getElementById("bg-music");
        bgMusic.volume=0.8
        const toggleMusicBtn = document.getElementById("toggle-music");

        let isMusicPlaying = localStorage.getItem("musicPlaying") !== "false"; // m·∫∑c ƒë·ªãnh l√† true

        if (!isMusicPlaying) {
          bgMusic.pause();
          toggleMusicBtn.textContent = "üîá";
        } else {
          const savedTime = sessionStorage.getItem("bgMusicTime");
          if (savedTime) {
            bgMusic.currentTime = parseFloat(savedTime);
          }
          bgMusic.play();
          toggleMusicBtn.textContent = "üîä";
        }

        toggleMusicBtn.addEventListener("click", function () {
          isMusicPlaying = !isMusicPlaying;
          if (isMusicPlaying) {
            bgMusic.play();
            toggleMusicBtn.textContent = "üîä";
          } else {
            bgMusic.pause();
            toggleMusicBtn.textContent = "üîá";
          }
          localStorage.setItem("musicPlaying", isMusicPlaying);
        });
        window.addEventListener("beforeunload", () => {
          sessionStorage.setItem("bgMusicTime", bgMusic.currentTime);
        });
        //dangnhap
        const user = JSON.parse(sessionStorage.getItem("currentUser"));
        const nutDangNhap = document.getElementById("nut-dang-nhap");

        if (!user) {
            document.getElementById("ten-nguoi-choi").textContent = "Ch∆∞a ƒëƒÉng nh·∫≠p";
            document.getElementById("kc-hientai").textContent = "0";
            document.getElementById("cap-bac").textContent = "VIP 0";
            nutDangNhap.textContent = "ƒêƒÉng nh·∫≠p";
            nutDangNhap.onclick = () => {
            window.location.href = "dangnhap.html";
            };
        } else {
            const users = JSON.parse(localStorage.getItem("users")) || [];
            const userr = users.find(u => u.email === user.email);
            document.getElementById("ten-nguoi-choi").textContent = user.username;
            document.getElementById("kc-hientai").textContent = userr.kimcuong || 0;
            nutDangNhap.textContent = "ƒêƒÉng xu·∫•t";
            nutDangNhap.onclick = logout;
            // T·ªïng Zeni n·∫°p
            let tongZeniDaNap = userr.history.reduce((sum, log) => sum + log.zeni, 0);
            document.getElementById("cap-bac").textContent = getCapBac(tongZeniDaNap);
            // C·∫≠p nh·∫≠t thanh VIP
            const capBacSpan = document.getElementById("cap-bac");
            const vipNext = document.getElementById("vip-next");

            const vipMoc = [0, 1000, 5000, 10000, 20000, 50000, 100000, 200000, 300000, 500000];
            let capHienTai = 0;
            for (let i = 0; i < vipMoc.length; i++) {
                if (tongZeniDaNap < vipMoc[i]) {
                capHienTai = i - 1;
                break;
                } else if (i === vipMoc.length - 1) {
                capHienTai = i;
                }
            }
            const vipBadges = [
            "Base Form",         // VIP 0
            "SSJ 1 ‚ö°",         // VIP 1
            "SSJ 2 ‚ö°", // VIP 2
            "SSJ 3 ‚ö°",       // VIP 3
            "SSJ GOD üî•",       // VIP 4
            "SSJ BLUE üî•",       // VIP 5
            "SSJ ROSE üî•",      // VIP 6
            "Ultra Instinct -Sign- üî∑",       // VIP 7
            "True Ultra Instinct üî∑",// VIP 8
            "Master Ultra Instinct üí†"     // Huy·ªÅn tho·∫°i
            ];
            let danhHieu = [];
            danhHieu.push(vipBadges[capHienTai]);
            const danhHieuDiv = document.getElementById("danh-hieu");
            danhHieuDiv.innerHTML = danhHieu.map(b => `<span class="badge">${b}</span>`).join("");
             // Ch·ªçn avatar theo c·∫•p VIP
            const avatar = document.getElementById("avatar-nguoi-choi");

            if (capHienTai >= 0 && capHienTai <= 8) {
            avatar.src = `images/avt${capHienTai+1}.webp`;
            } else {
            avatar.src = "images/avt10.webp"; // Huy·ªÅn tho·∫°i
            }

            capBacSpan.textContent = capHienTai >= vipMoc.length - 1 ? "üëë Huy·ªÅn Tho·∫°i R·ªìng Thi√™ng" : `VIP ${capHienTai}`;
            avatar.className = "avatar-frame"; // reset
            if (capHienTai >= 0 && capHienTai <= 8) {
            avatar.classList.add(`vip-frame-${capHienTai}`);
            } else {
            avatar.classList.add("legendary-frame");
            }

            if (capHienTai < vipMoc.length - 1) {
                const mucHienTai = vipMoc[capHienTai];
                const mucTiepTheo = vipMoc[capHienTai + 1];
                const tienTrinh = ((tongZeniDaNap - mucHienTai) / (mucTiepTheo - mucHienTai)) * 100;
                document.getElementById("vip-bar").style.width = tienTrinh + "%";
                vipNext.textContent = `üîí B·∫°n c·∫ßn th√™m ${(mucTiepTheo - tongZeniDaNap).toLocaleString()} Zeni ƒë·ªÉ l√™n VIP ${capHienTai + 1}`;
            } else {
                document.getElementById("vip-bar").style.width = "100%";
                vipNext.textContent = "üéâ B·∫°n ƒë√£ tr·ªü th√†nh chi·∫øn binh trong truy·ªÅn thuy·∫øt!";
            }

            // L·ªãch s·ª≠ n·∫°p
            document.getElementById("lich-su-nap").innerHTML = userr.history.map(log => `
            <tr>
                <td>${log.time}</td>
                <td>${log.zeni}</td>
                <td>${log.vnd.toLocaleString()}</td>
            </tr>
            `).join('');
        
            // Danh s√°ch item ƒë√£ mua
            const tbody = document.getElementById("lich-su-item");
            tbody.innerHTML = userr.items.map(i => `
            <tr>
                <td>${i.time}</td>
                <td>${i.id}</td>
                <td>${i.gia}</td>
                <td><button onclick="copyCode('${i.code}')">üìã Copy</button></td>
            </tr>
            `).join('');

        }

        function getCapBac(tong) {
            if (tong < 1000) return "VIP 0";
            if (tong < 5000) return "VIP 1";
            if (tong < 10000) return "VIP 2";
            if (tong < 20000) return "VIP 3";
            if (tong < 50000) return "VIP 4";
            if (tong < 100000) return "VIP 5";
            if (tong < 200000) return "VIP 6";
            if (tong < 300000) return "VIP 7";
            if (tong < 500000) return "VIP 8";
            return "üëë Huy·ªÅn Tho·∫°i R·ªìng Thi√™ng";
        }

        function logout() {
            sessionStorage.removeItem("currentUser");
            showToast("‚úÖ ƒêƒÉng xu·∫•t th√†nh c√¥ng!");
            location.reload();
        }
    
        function copyCode(code) {
        navigator.clipboard.writeText(code);
        showToast(`‚úÖ ƒê√£ copy m√£: ${code}`);
        }
        function showToast(message) {
        const toast = document.getElementById("toast");
        if (!toast) return;
        toast.textContent = message;
        toast.className = "show";
        setTimeout(() => {
            toast.className = "hidden";
        }, 3000);
        }

    </script>
</body>
</html>