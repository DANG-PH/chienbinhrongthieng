<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Chiến Binh Rồng Thiêng</title>
  <link rel="stylesheet" href="style.css" />
  <link rel="icon" href="images/icongame1.png" type="image/png" />
  <style>
    #nv-popup-online{
      position:fixed;
      display:none;
      top:50%;
      left:50%;
      transform:translate(-50%,-50%);
      padding:20px;
      border-radius:12px;
      z-index:1001;
      max-width:845px;
      background-color: #333;
      box-shadow: 0 0 8px rgba(255,255,255,0.6);
    }
    body:not(.dark-mode) #nv-popup-online{
      background-color: 	#f8f6f1;
      box-shadow: 0 0 12px rgba(0,0,0,0.4);
    }
    .nv-online-grid {
      display: grid;
      grid-template-columns: repeat(1, 1fr);
      width: 760px;
      gap: 15px;
      margin-top: 15px;
      height:450px;
      overflow-y: auto;
      scrollbar-width: none;
      }
    .nv-online-item {
      display: flex;
      border-radius: 10px;
      padding: 10px;
      background: rgba(30,30,30,0.75);
      box-shadow: 0 0 8px rgba(255,255,255,0.2);
      align-items: center;
    }
    .nv-online-item p{
      margin-left: 15px  ;
      margin-top: -8px;
      margin-bottom: 5px;
    }
    .nv-online-item h3{
      color:#ffa500;
      margin-top:4px;
      margin-left:15px
    }
    .nv-nhan-thuong{
      display:flex;
      justify-content: space-between;
      align-items: center;
      width: 100%;
    }
    .nv-nhan-thuong button{
      margin:0;
      font-size: 12px;
      padding:10px 16px
    }
    .nv-nhan-thuong p{
      margin:0;
      margin-left:15px
    }
    body:not(.dark-mode) .nv-online-item h3{
      color:black
    }
    .nv-online-item:hover{
      transform:translateY(-2px);
      box-shadow: 0px 0px 20px rgba(255,165,0,0.5);
      transition:.25s
    }
    body:not(.dark-mode) .nv-online-item{
      background: #fffaf0;
      border: 1px solid rgba(0, 0, 0, 0.2);
      box-shadow: 0 0px 8px rgba(0, 0, 0, 0.08); 
    }
    body:not(.dark-mode) .nv-online-item:hover{
      box-shadow: 0 0 20px rgba(100,100,255,0.8);
      transition:.25s
    }
    .nv-online-item img {
    width: 20%;
    height: 100px;
    border-radius: 8px;
    }
    .box-chua-nv{
      width: 80%;
    }
    body:not(.dark-mode) #nv-bar{
      background:#1976d2 !important;
    }
    #popup-online{
      position:fixed;
      display:none;
      top:50%;
      left:50%;
      transform:translate(-50%,-50%);
      padding:20px;
      border-radius:12px;
      z-index:1001;
      max-width:845px;
      padding-right:0px;
      background-color: #333;
      box-shadow: 0 0 8px rgba(255,255,255,0.6);
    }
    body:not(.dark-mode) #popup-online{
      background-color: 	#f8f6f1;
      box-shadow: 0 0 12px rgba(0,0,0,0.4);
    }
    .online-grid {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      width: 860px;
      gap: 15px;
      margin-top: 15px;
      }
    .online-item {
      border-radius: 10px;
      text-align: center;
      padding: 10px;
      background: rgba(30,30,30,0.75);
      box-shadow: 0 0 8px rgba(255,255,255,0.2);
    }
    .online-item:hover{
      transform:translateY(-5px);
      box-shadow: 0px 0px 20px rgba(255,165,0,0.5);
      transition:.25s
    }
    body:not(.dark-mode) .online-item{
      box-shadow: 0 0 12px rgba(0,0,0,0.4);
      background: #fffaf0
    }
    body:not(.dark-mode) .online-item:hover{
      box-shadow: 0 0 20px rgba(100,100,255,0.8);
      transition:.25s
    }
    .online-item img {
    width: 100%;
    height: 100px;
    object-fit: cover;
    border-radius: 8px;
    }

    .online-item button {
      margin-top: 12px;
      padding: 6px 12px;
      font-weight: bold;
      
    }

    .online-item p {
      margin-top: 5px;
      font-size: 14px;
    }

    .online-item.large {
      grid-column: 4 / -1;
      grid-row: 1 / 3;
      width:280px;
    }
    .online-item.large img{
      height:200px
    }
    .online-item.large button{
      padding:10px 110px;
      margin-top:30px
    }

    .vip strong{
      color:#1976d2
    }
    body.dark-mode .vip strong{
      color:#ffa500;
    }
    #toast {
    position: fixed;
    opacity:0;
    bottom:66%;
    left: 50%;
    transform: translateX(-50%);
    background: #9e9e9e;
    box-shadow: 0 4px 12px rgba(0,0,0,0.7);
    color: black;
    padding: 8px 20px;
    border-radius: 8px;
    font-size: 14px;
    z-index: 9999;
    transition: opacity 0.5s ease, transform 0.5s ease;
    }
    body.dark-mode #toast {
    background: rgba(0, 0, 0, 0.8);
    box-shadow: 0 4px 12px rgba(255,255,255,0.2);
    color: #fff;
    }
    #toast.show {
    opacity: 1;
    transform: translateX(-50%) translateY(0);
    }
    #toast.hidden {
    opacity: 0;
    pointer-events: none;
    }
    .avatar-frame {
    border-radius: 50%;
    object-fit: cover;
    border: 3px solid transparent;
    }

    .vip-frame-0 { border-color: gray; }
    .vip-frame-1 { border-color: #ffeb3b; box-shadow: 0 0 6px #ffeb3b}
    .vip-frame-2 { border-color: #ffc107; box-shadow: 0 0 8px #ffc107 }
    .vip-frame-3 { border-color: gold; box-shadow: 0 0 10px gold }
    .vip-frame-4 { border-color: #ff1744;box-shadow: 0 0 12px #ff1744 }
    .vip-frame-5 { border-color: #2979ff; box-shadow: 0 0 12px #2979ff ;animation: glow-vip5 2.5s infinite;}
    .vip-frame-6 { border-color: #ec407a;box-shadow: 0 0 12px #ec407a ;animation: glow-vip6 2.5s infinite;}
    .vip-frame-7 { border-color: #b2ebf2; box-shadow: 0 0 12px #b2ebf2 ;animation: glow-vip7 2.5s infinite;}
    .vip-frame-8 { border-color: #00e5ff; box-shadow: 0 0 12px #00e5ff ;animation: glow-vip8 2.5s infinite;}
    .legendary-frame {
      border-color: #B0F1FF;
      box-shadow: 0 0 25px #B0F1FF	;
      animation: glow-pulse 2s infinite;

    }
    body.dark-mode .legendary-frame {
      border-color: #ffffff;
      box-shadow: 0 0 25px #ffffff;
      animation: glow-pulse1 2s infinite;
      
    }
    @keyframes glow-vip5 {
      0% { box-shadow: 0 0 7px #2979ff; }
      50% { box-shadow: 0 0 21px #2979ff; }
      100% { box-shadow: 0 0 7px #2979ff; }
    }
    @keyframes glow-vip6 {
      0% { box-shadow: 0 0 9px #ec407a; }
      50% { box-shadow: 0 0 24px #ec407a; }
      100% { box-shadow: 0 0 9px #ec407a; }
    }
    @keyframes glow-vip7 {
      0% { box-shadow: 0 0 10px #b2ebf2; }
      50% { box-shadow: 0 0 28px #b2ebf2; }
      100% { box-shadow: 0 0 10px #b2ebf2; }
    }
    @keyframes glow-vip8 {
      0% { box-shadow: 0 0 10px #00e5ff; }
      50% { box-shadow: 0 0 32px #00e5ff; }
      100% { box-shadow: 0 0 10px #00e5ff; }
    }
    @keyframes glow-pulse {
      0% {
        transform: scale(1);
        box-shadow:0 0 15px #00e5ff
      }
      50% {
        transform: scale(1.03);
        box-shadow:0 0 45px #00e5ff
      }
      100% {
        transform: scale(1);
        box-shadow:0 0 15px #00e5ff
      }
    }
  @keyframes glow-pulse1 {
    0% {
      transform: scale(1);
      box-shadow: 0 0 15px #ffffff;
    }
    50% {
      transform: scale(1.03);
      box-shadow: 0 0 45px #ffffff;
    }
    100% {
      transform: scale(1);
      box-shadow: 0 0 15px #ffffff;
    }
  }

    /*  */
    .badge {
    display: inline-block;
    background: linear-gradient(to right, #ffcc00, #ff9900);
    color: white;
    padding: 4px 10px;
    border-radius: 20px;
    font-size: 13px;
    margin: 3px;
    box-shadow: 0 2px 15px rgba(255,165,0,0.5);
    }
    #notification-popup {
      background-color: #fff;  
      color: #000;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3); 
    }
    body.dark-mode #notification-popup {
      background-color: rgba(0, 0, 0, 0.85);
      color: #eee;
      box-shadow: 0 4px 12px rgba(255, 255, 255, 0.1);
    }
    #notification-popup a{
      color:#2979ff
    }
    body.dark-mode #notification-popup a{
      color:#ffa500
    }
    #form-nhap-code {
      display: none;
      position:fixed;
      top:50%;
      left:50%;
      transform:translate(-50%,-50%);
      background:#ffffff;
      padding:24px 20px;
      border-radius:15px;
      z-index:1001;
      max-width:400px;
      width:90%;
      box-shadow:0 8px 20px rgba(0,0,0,0.4);
      font-family:'Segoe UI',sans-serif;
    }

    #code-input{
      width:100%;
      padding:10px 12px;
      margin-top:8px;
      border:2px solid #ccc;
      border-radius:8px;font-size:14px;
    }
    body.dark-mode #form-nhap-code {
      background-color: #2e2e2e;  /* xám tối vừa phải */
    }
    body.dark-mode #code-input {
      background-color: #3a3a3a;
      color: #fff;
      border: 2px solid #777; 
      box-shadow: 0 0 4px rgba(255,255,255,0.1);
      outline-color: #888;
    }
    body.dark-mode #code-input::placeholder {
      color: #bbb;
    }

  
    @media (max-width: 768px) {
        table{
            font-size:11px;
        }
        button {
            font-size:10px;
            padding:6px 12px
        }
        .vbar {
            height:12px !important;
        }
        #avatar-nguoi-choi{
            width:100px !important;
            height: 100px !important;
        }
        .badge{
          font-size: 10px;
        }
        #popup-online{
          padding-right:20px;
          height:625px;
        }
        .online-grid {
          display: grid;
          grid-template-columns: repeat(3, 1fr);
          width: 350px;
          height:400px;
          gap: 12px;
        }
        .online-item{
          height:122px;
          padding:2px;
        }
        .online-item img{
          height:70px;
        }
        .online-item.large {
          grid-column: 1 / -1; /* chiếm toàn bộ hàng */
          grid-row: 3;
          width: 100%;
          height:285px
        }
        .online-item.large button{
          width: 150px !important;
          padding:6px !important;
        }
        .online-item.large img{
          height: 170px !important;
        }
        .online-item button{
          font-size:8px;
          padding:4px 9px;
          margin-top:0px !important;
        }
        .online-item p{
          font-size:9px !important;
        }

        .online-item.large img {
          height: 160px;
          object-fit: cover;
        }

        .online-item.large button {
          width: 100%;
          padding: 12px 0;
          margin-top: 12px;
        }

        .online-item.large p {
          font-size: 13px;
          line-height: 1.4;
        }
        #nv-popup-online{
          width: 400px !important;
          padding:10px;
        }
        .nv-online-grid {
          width: 380px;
          height:380px;
          gap: 12px;
        }
        .nv-online-item{
          height:105px
        }
        .nv-online-item img{
          width: 25%;
          height:85px
        }
        .nv-online-item button{
          font-size: 9px;
          padding:7px 12px
        }
        .nvbar {
          height:12px !important;
        }
        #mediaht{
          width: 20% !important;
          margin-right: 20px;
        }
      }


  </style>
</head>
<body>
  <div class="header">
    <div style="overflow: hidden;">
      <video autoplay muted loop playsinline preload="metadata" poster="images/quenmatkhau2.webp" class="header-video" style="animation: vid1 10s infinite;height:100%;filter: brightness(0.9)">
        <source src="images/quenmatkhau2.webm" type="video/webm">
        <source src="images/quenmatkhau2.mp4" type="video/mp4">
      </video>
      <video autoplay muted loop playsinline preload="metadata" poster="images/tintuc2.webp" class="header-video" style="animation: vid2 10s infinite;filter: brightness(0.9)">
        <source src="images/tintuc2.webm" type="video/webm">
        <source src="images/tintuc2.mp4" type="video/mp4">
      </video>
    </div>
    <div class="overlay"></div>
        <div class="header-content" >
            <h1>Profile Chiến Binh!</h1>
            <div>
              <ul>
                <li><a href="index.html">Trang chủ</a></li>
                <li><a href="gioithieu.html">Giới thiệu</a></li>
                <li><a href="nhanvat.html">Nhân Vật</a></li>
                <li><a href="diendan.html">Diễn đàn</a></li>
                <li><a href="https://www.facebook.com/people/Chi%E1%BA%BFn-Binh-R%E1%BB%93ng-Thi%C3%AAng/61576541835732/" target="_blank">Fanpage</a></li>
                <li><a href="tintuc.html">Tin tức</a></li>
                <li><a href="huongdanchoi.html">Hướng dẫn chơi</a></li>
                <li><a href="choingay.html">Chơi ngay</a></li>
                <li><a href="naptien.html">Nạp game</a></li>
                <li><a href="shop.html">Shop rồng thiêng</a></li>
                <li><a href="chatbot.html">Chat bot hỗ trợ</a></li>
                <li><a href="profile.html" id="selected">Profile</a></li>
                <li><a href="vinhdanh.html">Vinh danh chiến binh</a></li>
              </ul>
            </div>
        </div>
    </div>
    <div class="bg-content1">
        <div style="float:right;margin-top:5px">
            <label class="switch">
                <input type="checkbox" id="darkModeToggle">
                <span class="slider round"></span>
            </label>
        </div>
        <h2>Truyền Thuyết Rồng Thiêng Bắt Đầu Từ Bạn</h2>
        <p><i><b>Không phải ai cũng đủ sức mạnh để viết nên huyền thoại... Nhưng bạn đang làm điều đó ngay lúc này!</b></i></p>
    </div>
    <div class="bg-content1">
        <h2>Thông tin người chơi</h2>
        <div style="text-align:center; margin-bottom:10px;">
            <img id="avatar-nguoi-choi" class="avatar-frame" src="images/head1.webp" style="width:140px; height:140px;">
        </div>
        <p>Tên tài khoản: <strong id="ten-nguoi-choi">...</strong></p>
        <p>Số Zeni hiện có: <strong id="kc-hientai">0</strong></p>
        <p class="vip">Cấp bậc chiến binh: <strong id="cap-bac"><span>VIP 0</span></strong></p>
        <div id="danh-hieu" style="margin:10px 0;"></div>
        <div style="margin-top:10px;">
            <div class="vbar"style="background:#ccc; width:100%; height:20px; border-radius:10px; overflow:hidden;">
                <div id="vip-bar" style="height:100%; width:0%; background:#f90;"></div>
            </div>
            <p id="vip-next" style="margin-top:5px;font-style: italic;">Hãy nạp Zeni để lên VIP , thay đổi avatar và sở hữu nhiều đặc quyền khác nhé chiến binh !</p>
        </div>
        <!-- Nút mở form -->
        <div style="display:flex;justify-content: space-between;padding: 0;margin: 0px;">
          <button id="nut-dang-nhap" style="margin-top: 10px;">Đăng nhập</button>
          <button class="download-buttons"onclick="hienNhapCode()">🔑 Nhập mã đổi thưởng</button>
        </div>
        <div style="display:flex;justify-content: space-between;padding: 0;margin: 0px;">
          <button onclick="hienPopupOnline()">🎁 Nhận quà online</button>
          <button onclick="hienNhiemvuHangNgay()">🎁 Nhiệm vụ hằng ngày</button>
        </div>
    </div>
    <!-- Overlay nền mờ -->
    <div id="overlay-online" style="display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.6);z-index:1000;"></div>

    <!-- Popup phần quà online -->
    <div id="popup-online">
      <button onclick="anPopupOnline()" style="position:absolute;top:10px;right:10px;background:none;border:none;font-size:18px;box-shadow:none">❌</button>
      <h3 style="text-align:center;margin-top:0;">🎁 Quà online hằng ngày</h3>
      <div class="online-grid">
        <div class="online-item"><img src="images/ol1.png"><button onclick="nhanThuongMoc(10)">Nhận</button><p>10 phút</p></div>
        <div class="online-item"><img src="images/ol2.png"><button onclick="nhanThuongMoc(20)">Nhận</button><p>20 phút</p></div>
        <div class="online-item"><img src="images/ol3.png"><button onclick="nhanThuongMoc(40)">Nhận</button><p>40 phút</p></div>
        <div class="online-item"><img src="images/ol3.png"><button onclick="nhanThuongMoc(70)">Nhận</button><p>70 phút</p></div>
        <div class="online-item"><img src="images/ol4.png"><button onclick="nhanThuongMoc(100)">Nhận</button><p>100 phút</p></div>
        <div class="online-item"><img src="images/ol4.png"><button onclick="nhanThuongMoc(140)">Nhận</button><p>140 phút</p></div>

        <div class="online-item large">
          <img src="images/ol5.png">
          <button onclick="nhanThuongMoc(180)">Nhận</button>
          <p>180 phút</p>
          <p>🎉 Phần thưởng tối đa trong ngày! <br> Nhận ngay 7250 Zeni khi online 180 phút!</p>
          <p id="online-time"><i></i></p>
        </div>
      </div>
    </div>
    <!-- Overlay nền mờ -->
    <div id="nv-overlay-online" style="display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.6);z-index:1000;"></div>

    <div id="nv-popup-online">
      <button onclick="anNhiemvuHangNgay()" style="position:absolute;top:10px;right:10px;background:none;border:none;font-size:18px;box-shadow:none">❌</button>
      <h3 style="text-align:center;margin-top:0;">🎁 Nhiệm Vụ Hằng Ngày</h3>
      <div class="nv-online-grid">
        <div class="nv-online-item">
          <img src="images/nhanvat1.webp">
          <div class="box-chua-nv">
            <h3>Thấu hiểu nhân vật</h3>
            <p>Khám phá hồ sơ nhân vật – nơi ẩn chứa bí mật sức mạnh và tiềm năng vô hạn!</p>
            <div class="nv-nhan-thuong">
              <p>Nhận thưởng : <span class="vip"><strong>2000 Zeni !</strong></span></p>
              <button>Nhận thưởng</button>
            </div>
          </div>
        </div>
        <div class="nv-online-item">
          <img src="images/diendan1.webp">
          <div class="box-chua-nv">
            <h3>Thảo luận chiến binh</h3>
            <p>Tương tác diễn đàn chiến binh, chia sẻ chiến thuật và truyền cảm hứng bất tận!</p>
            <div class="nv-nhan-thuong">
              <p>Nhận thưởng : <span class="vip"><strong>3000 Zeni !</strong></span></p>
              <button>Nhận thưởng</button>
            </div>
          </div>
        </div>
        <div class="nv-online-item">
          <img src="images/tintuc2.webp">
          <div class="box-chua-nv">
            <h3>Nắm rõ chiến thuật</h3>
            <p>Vào trang tin tức và cập nhật meta mới nhất!</p>
            <div class="nv-nhan-thuong">
              <p>Nhận thưởng : <span class="vip"><strong>2000 Zeni !</strong></span></p>
              <button>Nhận thưởng</button>
            </div>
          </div>
        </div>
        <div class="nv-online-item">
          <img src="images/choingay1.webp">
          <div class="box-chua-nv">
            <h3>Bắt đầu cuộc chiến !</h3>
            <p>Chiến đấu không chần chừ – hãy lao vào trận chiến và khẳng định bản lĩnh!</p>
            <div class="nv-nhan-thuong">
              <p>Nhận thưởng : <span class="vip"><strong>5000 Zeni !</strong></span></p>
              <button>Nhận thưởng</button>
            </div>
          </div>
        </div>
        <div class="nv-online-item">
          <img src="images/vid1.webp">
          <div class="box-chua-nv">
            <h3>Động lực là sức mạnh</h3>
            <p>Chiến binh huyền thoại không chỉ chiến đấu giỏi, mà còn để lại dấu ấn rực rỡ trong lịch sử! - Vào trang Vinh Danh</p>
            <div class="nv-nhan-thuong">
              <p>Nhận thưởng : <span class="vip"><strong>2000 Zeni !</strong></span></p>
              <button>Nhận thưởng</button>
            </div>
          </div>
        </div>
        <div class="nv-online-item">
          <img src="images/goku2.jpg">
          <div class="box-chua-nv">
            <h3>Khí chất của thần</h3>
            <p>Nạp tiền lần đầu trong ngày, tăng cường sức mạnh, nâng cấp đột phá, mở khoá kỹ năng bá đạo!</p>
            <div class="nv-nhan-thuong">
              <p>Nhận thưởng : <span class="vip"><strong>10000 Zeni !</strong></span></p>
              <button>Nhận thưởng</button>
            </div>
          </div>
        </div>
      </div>
      <div style="margin-top: 20px;display:flex;align-items: center;">
        <div id="mediaht" style="width:16%;text-align: center;">
          <p>Hoàn thành</p>
          <p id="nv-so-hoan-thanh">0%</p>
        </div>
        <div class="nvbar"style="background:#ccc; width:84%; height:20px; border-radius:10px; overflow:hidden">
          <div id="nv-bar" style="height:100%; width:0%; background:#f90;"></div>
        </div>
      </div>
    </div>
    <div class="bg-content1">
    <h2>Lịch sử nạp Zeni gần đây</h2>
    <table border="1" style="width:100%;text-align:center">
        <thead>
        <tr>
            <th>Thời gian</th>
            <th>Số Zeni</th>
            <th>VNĐ</th>
        </tr>
        </thead>
        <tbody id="lich-su-nap"></tbody>
    </table>
    </div>
    <div class="bg-content1">
    <h2>🎒 Vật phẩm đã sở hữu</h2>
    <table border="1" style="width:100%;text-align:center">
        <thead>
        <tr>
            <th>Thời gian</th>
            <th>Vật phẩm</th>
            <th>Giá (Zeni)</th>
            <th>Mã Code</th>
        </tr>
        </thead>
        <tbody id="lich-su-item"></tbody>
    </table>
    </div>
    <!-- Overlay nền mờ -->
    <div id="overlay" style="display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.6);z-index:1000;"></div>

    <!-- Popup nhập code -->
    <div id="form-nhap-code" >
      <button onclick="anNhapCode()" style="position:absolute;top:10px;right:5px;background:none;border:none;font-size:10px;cursor:pointer;box-shadow:none">❌</button>
      <h3 style="margin:0 0 15px 0;text-align:center;font-size:20px;">🎁 Nhập mã Code đổi thưởng</h3>
      <input id="code-input" type="text" placeholder="Nhập mã code..."  />
      <button onclick="doiCode()" style="margin-top:15px;width:100%;padding:10px;border:none;border-radius:8px;font-size:16px;cursor:pointer;">Đổi mã ngay</button>
    </div>
    <audio id="bg-music" autoplay loop>
        <source src="sounds/phepmau.mp3" type="audio/mpeg">
        Trình duyệt của bạn không hỗ trợ âm thanh.
    </audio>
    <button id="toggle-music" class="music-toggle-btn">🔇</button>
    <footer>
        <p style="font-style: italic;"><strong>© 2025 Chiến Binh Rồng Thiêng | Phạm Hải Đăng</strong></p>
    </footer>
    <div id="toast"></div>
    <!-- Nút chuông thông báo -->
    <div id="notification-bell" style="position:fixed;top:20px;right:20px;z-index:1100;cursor:pointer;">
      🔔
    </div>

    <!-- Popup thông báo -->
    <div id="notification-popup"style="display:none;position:fixed;top:70px;right:20px;width:280px;padding:15px;border-radius:10px;z-index:1101;">
      <h3 style="margin-top:0;margin-bottom:10px;font-size:16px;">🔔 Thông báo</h3>
      <ul style="padding-left:18px;margin:0;font-size:14px;">
        <li>🎖 Bạn đã đạt cấp VIP mới? Kiểm tra ngay!</li>
        <li>🛒 Đừng bỏ lỡ khuyến mãi tại <a href="shop.html">Shop Rồng Thiêng</a>.</li>
        <li>📣 Hãy cập nhật hồ sơ của bạn trong phần <a href="profile.html">Profile</a>.</li>
      </ul>
    </div>

    <script>
        const toggle = document.getElementById("darkModeToggle");

        // Khi tải trang: kiểm tra trạng thái dark mode đã lưu
        if (localStorage.getItem("darkMode") === "true") {
        document.body.classList.add("dark-mode");
        toggle.checked = true;
        }

        // Khi người dùng bật/tắt dark mode
        toggle.addEventListener("change", function () {
        const isDark = toggle.checked;
        document.body.classList.toggle("dark-mode", isDark);
        localStorage.setItem("darkMode", isDark);
        });
        //audio 
        const bgMusic = document.getElementById("bg-music");
        bgMusic.volume=0.8
        const toggleMusicBtn = document.getElementById("toggle-music");

        let isMusicPlaying = localStorage.getItem("musicPlaying") !== "false"; // mặc định là true

        if (!isMusicPlaying) {
          bgMusic.pause();
          toggleMusicBtn.textContent = "🔇";
        } else {
          const savedTime = sessionStorage.getItem("bgMusicTime");
          if (savedTime) {
            bgMusic.currentTime = parseFloat(savedTime);
          }
          bgMusic.play();
          toggleMusicBtn.textContent = "🔊";
        }

        toggleMusicBtn.addEventListener("click", function () {
          isMusicPlaying = !isMusicPlaying;
          if (isMusicPlaying) {
            bgMusic.play();
            toggleMusicBtn.textContent = "🔊";
          } else {
            bgMusic.pause();
            toggleMusicBtn.textContent = "🔇";
          }
          localStorage.setItem("musicPlaying", isMusicPlaying);
        });
        window.addEventListener("beforeunload", () => {
          sessionStorage.setItem("bgMusicTime", bgMusic.currentTime);
        });
        //dangnhap
        const user = JSON.parse(sessionStorage.getItem("currentUser"));
        const nutDangNhap = document.getElementById("nut-dang-nhap");

        if (!user) {
            document.getElementById("ten-nguoi-choi").textContent = "Chưa đăng nhập";
            document.getElementById("kc-hientai").textContent = "0";
            document.getElementById("cap-bac").textContent = "VIP 0";
            nutDangNhap.textContent = "Đăng nhập";
            nutDangNhap.onclick = () => {
            window.location.href = "dangnhap.html";
            };
        } else {
            const users = JSON.parse(localStorage.getItem("users")) || [];
            const userr = users.find(u => u.email === user.email);
            document.getElementById("ten-nguoi-choi").textContent = user.username;
            document.getElementById("kc-hientai").textContent = userr.kimcuong || 0;
            nutDangNhap.textContent = "Đăng xuất";
            nutDangNhap.onclick = logout;
            // Tổng Zeni nạp
            let tongZeniDaNap = userr.history.reduce((sum, log) => sum + log.zeni, 0);
            document.getElementById("cap-bac").textContent = getCapBac(tongZeniDaNap);
            // Cập nhật thanh VIP
            const capBacSpan = document.getElementById("cap-bac");
            const vipNext = document.getElementById("vip-next");

            const vipMoc = [0, 1000, 5000, 10000, 20000, 50000, 100000, 200000, 300000, 500000];
            let capHienTai = 0;
            for (let i = 0; i < vipMoc.length; i++) {
                if (tongZeniDaNap < vipMoc[i]) {
                capHienTai = i - 1;
                break;
                } else if (i === vipMoc.length - 1) {
                capHienTai = i;
                }
            }
            const vipBadges = [
            "Base Form",         // VIP 0
            "SSJ 1 ⚡",         // VIP 1
            "SSJ 2 ⚡", // VIP 2
            "SSJ 3 ⚡",       // VIP 3
            "SSJ GOD 🔥",       // VIP 4
            "SSJ BLUE 🔥",       // VIP 5
            "SSJ ROSE 🔥",      // VIP 6
            "Ultra Instinct -Sign- 🔷",       // VIP 7
            "True Ultra Instinct 🔷",// VIP 8
            "Master Ultra Instinct 💠"     // Huyền thoại
            ];
            let danhHieu = [];
            danhHieu.push(vipBadges[capHienTai]);
            const danhHieuDiv = document.getElementById("danh-hieu");
            danhHieuDiv.innerHTML = `<span class="badge">${vipBadges[capHienTai]}</span>`;
             // Chọn avatar theo cấp VIP
            const avatar = document.getElementById("avatar-nguoi-choi");

            if (capHienTai >= 0 && capHienTai <= 8) {
            avatar.src = `images/avt${capHienTai+1}.webp`;
            } else {
            avatar.src = "images/vip10.1.avif"; // Huyền thoại
            }

            capBacSpan.textContent = capHienTai >= vipMoc.length - 1 ? "👑 Huyền Thoại Rồng Thiêng" : `VIP ${capHienTai}`;
            avatar.className = "avatar-frame"; // reset
            if (capHienTai >= 0 && capHienTai <= 8) {
            avatar.classList.add(`vip-frame-${capHienTai}`);
            } else {
            avatar.classList.add("legendary-frame");
            }

            if (capHienTai < vipMoc.length - 1) {
                const mucHienTai = vipMoc[capHienTai];
                const mucTiepTheo = vipMoc[capHienTai + 1];
                const tienTrinh = ((tongZeniDaNap - mucHienTai) / (mucTiepTheo - mucHienTai)) * 100;
                document.getElementById("vip-bar").style.width = tienTrinh + "%";
                vipNext.textContent = `🔒 Bạn cần thêm ${(mucTiepTheo - tongZeniDaNap).toLocaleString()} Zeni để lên VIP ${capHienTai + 1}`;
            } else {
                document.getElementById("vip-bar").style.width = "100%";
                document.getElementById("vip-bar").style.background = "line-gradient(to right,#b2ebf2,#00e5ff)";
                vipNext.textContent = "🎉 Bạn đã trở thành chiến binh trong truyền thuyết!";
            }
            
            // Lịch sử nạp
            document.getElementById("lich-su-nap").innerHTML = userr.history.map(log => {
              const thoiGian = new Date(log.time).toLocaleString("vi-VN", {
                timeZone: "Asia/Ho_Chi_Minh"
              });
              return `
            <tr>
                <td>${thoiGian}</td>
                <td>${log.zeni}</td>
                <td>${log.vnd.toLocaleString()}</td>
            </tr>`;
            }).join('');

        
            // Danh sách item đã mua
            const tbody = document.getElementById("lich-su-item");
            tbody.innerHTML = userr.items.map(i => `
            <tr>
                <td>${i.time}</td>
                <td>${i.id}</td>
                <td>${i.gia}</td>
                <td><button onclick="copyCode('${i.code}')">📋 Copy</button></td>
            </tr>
            `).join('');

        }

        function getCapBac(tong) {
            if (tong < 1000) return "VIP 0";
            if (tong < 5000) return "VIP 1";
            if (tong < 10000) return "VIP 2";
            if (tong < 20000) return "VIP 3";
            if (tong < 50000) return "VIP 4";
            if (tong < 100000) return "VIP 5";
            if (tong < 200000) return "VIP 6";
            if (tong < 300000) return "VIP 7";
            if (tong < 500000) return "VIP 8";
            return "👑 Huyền Thoại Rồng Thiêng";
        }

        function logout() {
            sessionStorage.removeItem("currentUser");
            showToast("✅ Đăng xuất thành công!");
            location.reload();
        }
    
        function copyCode(code) {
        navigator.clipboard.writeText(code);
        showToast(`✅ Đã copy mã: ${code}`);
        }
        function showToast(message) {
        const toast = document.getElementById("toast");
        if (!toast) return;
        toast.textContent = message;
        toast.className = "show";
        setTimeout(() => {
            toast.className = "hidden";
        }, 3000);
        }
        function hienNhapCode() {
          document.getElementById("form-nhap-code").style.display = "block";
          document.getElementById("overlay").style.display = "block";
        }

        function anNhapCode() {
          document.getElementById("form-nhap-code").style.display = "none";
          document.getElementById("overlay").style.display = "none";
        }

        function doiCode() {
          const codeInput = document.getElementById("code-input");
          const code = codeInput.value.trim().toUpperCase(); // chuẩn hóa mã
          const currentUser = JSON.parse(sessionStorage.getItem("currentUser"));
          if (!currentUser) {
            showToast("⚠️ Bạn cần đăng nhập để sử dụng mã code.");
            return;
          }
          if (code === "") {
            showToast("⚠️ Vui lòng nhập mã code.");
            return;
          }
          const users = JSON.parse(localStorage.getItem("users")) || [];
          const user = users.find(u => u.email === currentUser.email);

          if (!user.items) {
            showToast("❌ Không tìm thấy người dùng!");
            return;
          }

          const matchedItem = user.items.find(i => i.code === code);

          if (!matchedItem) {
            showToast("❌ Mã code không đúng hoặc không thuộc tài khoản bạn.");
            return;
          }

          if (matchedItem.used) {
            showToast("⚠️ Mã này đã được sử dụng rồi!");
            return;
          }

          // ✅ Đổi mã thành công
          matchedItem.used = true;
          localStorage.setItem("users", JSON.stringify(users));
          showToast(`✅ Bạn vừa nhận quà từ mã ${code}!`);
          codeInput.value = "";
          anNhapCode();

          // 👉 Có thể tùy chọn cộng thêm Zeni tùy loại item
        }
        // Toggle popup chuông
        document.getElementById("notification-bell").addEventListener("click", () => {
          const popup = document.getElementById("notification-popup");
          popup.style.display = popup.style.display === "none" ? "block" : "none";
        });


    </script>
    <script>
      function hienPopupOnline() {
        document.getElementById("overlay-online").style.display = "block";
        document.getElementById("popup-online").style.display = "block";
      }
      function anPopupOnline() {
        document.getElementById("overlay-online").style.display = "none";
        document.getElementById("popup-online").style.display = "none";
      }
      const currentUser = JSON.parse(sessionStorage.getItem("currentUser"));
      const ngayHomNay = new Date().toISOString().split("T")[0];

      if (currentUser) {
        const email = currentUser.email;
        const onlineKey = `onlineTimeData_${email}`;
        const nhanKey = `dd_nhan_${email}`;

        // Lấy dữ liệu thời gian online của người dùng hôm nay
        let data = JSON.parse(localStorage.getItem(onlineKey)) || {};
        if (!data[ngayHomNay]) {
          data[ngayHomNay] = { start: Date.now() };
          localStorage.setItem(onlineKey, JSON.stringify(data));
        }

        let startTime = data[ngayHomNay].start;

        // Hiển thị phút ngay khi vào
        function capNhatPhutOnline() {
          const minutes = Math.floor((Date.now() - startTime) / 60000);
          document.getElementById("online-time").textContent = `⏳ Đã online: ${minutes} phút hôm nay`;
          return minutes;
        }
        capNhatPhutOnline();

        // Cập nhật mỗi 10s
        setInterval(capNhatPhutOnline, 10);

        // Mốc thưởng
        const mocThuong = {
          10: 340,
          20: 690,
          40: 1400,
          70:1400,
          100:3550,
          140:3550,
          180: 7250
        };

        // Nhận thưởng
        function nhanThuongMoc(phut) {
          const minutesOnline = capNhatPhutOnline();
          if (minutesOnline < phut) {
            return showToast(`❌ Cần online ít nhất ${phut} phút để nhận mốc này!`);
          }

          const daNhan = JSON.parse(localStorage.getItem(nhanKey)) || {};
          const daHomNay = daNhan[ngayHomNay] || [];
          if (daHomNay.includes(phut)) {
            return showToast("❌ Bạn đã nhận mốc này hôm nay!");
          }

          const users = JSON.parse(localStorage.getItem("users")) || [];
          const me = users.find(u => u.email === email);
          me.kimcuong = (me.kimcuong || 0) + mocThuong[phut];
          localStorage.setItem("users", JSON.stringify(users));
          document.getElementById("kc-hientai").textContent = me.kimcuong;

          daHomNay.push(phut);
          daNhan[ngayHomNay] = daHomNay;
          localStorage.setItem(nhanKey, JSON.stringify(daNhan));

          showToast(`✅ Bạn đã nhận ${mocThuong[phut].toLocaleString()} Zeni!`);
        }

        // Gắn lên global
        window.nhanThuongMoc = nhanThuongMoc;

      } else {
        document.getElementById("online-time").textContent = "Chưa đăng nhập";
        function nhanThuongMoc(phut){
          return showToast("⚠️ Bạn cần đăng nhập để nhận quà online.")
        }
      }
      </script>
      <script>
        function hienNhiemvuHangNgay(){
          document.getElementById("nv-popup-online").style.display = "block";
          document.getElementById("nv-overlay-online").style.display = "block";
        }

        function anNhiemvuHangNgay(){
          document.getElementById("nv-popup-online").style.display = "none";
          document.getElementById("nv-overlay-online").style.display = "none";
        }

        document.querySelectorAll(".nv-nhan-thuong button").forEach((btn, index) => {
          btn.onclick = () => nhanThuongNV(index);
        });

        function nhanThuongNV(id){
          const userr = JSON.parse(sessionStorage.getItem("currentUser"));
          if (!userr) return showToast("⚠️ Cần đăng nhập để nhận thưởng!");
          const users = JSON.parse(localStorage.getItem("users")) || [];
          const me = users.find(u => u.email === userr.email);
          const email = me.email
          const key = `nvhn_${email}`;
          const ngay = new Date().toISOString().split("T")[0];
          const data = JSON.parse(localStorage.getItem(key)) || {};
          if (!data[ngay]) data[ngay] = [];

          if (data[ngay].includes(id)) {
            return showToast("❌ Nhiệm vụ này đã nhận hôm nay!");
          }

          const phanThuong = [2000, 3000, 2000, 5000, 2000, 10000];
          if (id === 5) {
            const daNap = (me.history || []).some(log => {
              const ngayLog = new Date(log.time).toISOString().split("T")[0];
              return ngayLog === ngay;
            });
            if (!daNap) {
              return showToast("❌ Bạn cần nạp tiền hôm nay mới nhận được nhiệm vụ này!");
            }
          }

          me.kimcuong = (me.kimcuong || 0) + phanThuong[id];
          localStorage.setItem("users", JSON.stringify(users));

          document.getElementById("kc-hientai").textContent = me.kimcuong;
          data[ngay].push(id);
          localStorage.setItem(key, JSON.stringify(data));

          showToast(`✅ Đã nhận ${phanThuong[id].toLocaleString()} Zeni!`);
          capNhatTienTrinhNV();
        }


        function capNhatTienTrinhNV(){
          const email = JSON.parse(sessionStorage.getItem("currentUser")).email;
          const key = `nvhn_${email}`;
          const ngay = new Date().toISOString().split("T")[0];
          const data = JSON.parse(localStorage.getItem(key)) || {};
          const daNhan = data[ngay];
          const progress = (daNhan.length / 6) * 100;
          document.getElementById("nv-bar").style.width = progress + "%";
          document.getElementById("nv-so-hoan-thanh").textContent = `${Math.floor(progress)}%`;
        }

        window.onload = capNhatTienTrinhNV;
        </script>
      </body>
</html>